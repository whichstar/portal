(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c90cf17"],{"15eb":function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-card",{attrs:{header:e.$route.meta.title,shadow:"never"}},[l("el-form",{attrs:{inline:!0,model:e.listQuery}},[l("el-form-item",{attrs:{label:"日期:"}},[l("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.listQuery.queryDate,callback:function(t){e.$set(e.listQuery,"queryDate",t)},expression:"listQuery.queryDate"}})],1),l("el-form-item",{attrs:{prop:"customerId",label:"客户名:"}},[l("el-select",{attrs:{loading:e.customerLoading,clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.listQuery.customerId,callback:function(t){e.$set(e.listQuery,"customerId",t)},expression:"listQuery.customerId"}},e._l(e.customerOptions,function(e){return l("el-option",{key:e.id,attrs:{label:e.nickname,value:e.id}})}),1)],1),l("el-form-item",{attrs:{prop:"channelId",label:"通道:"}},[l("el-select",{attrs:{loading:e.channelLoading,clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.listQuery.channelId,callback:function(t){e.$set(e.listQuery,"channelId",t)},expression:"listQuery.channelId"}},e._l(e.channelOptions,function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),l("el-form-item",{attrs:{prop:"mobile",label:"手机号码:"}},[l("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.listQuery.mobile,callback:function(t){e.$set(e.listQuery,"mobile",t)},expression:"listQuery.mobile"}})],1),l("el-form-item",{attrs:{prop:"messageId",label:"发送流水号:"}},[l("el-input",{attrs:{placeholder:"发送流水号"},model:{value:e.listQuery.messageId,callback:function(t){e.$set(e.listQuery,"messageId",t)},expression:"listQuery.messageId"}})],1),l("el-form-item",{attrs:{label:"省份:"}},[l("el-select",{attrs:{loading:e.provinceLoading,filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.listQuery.province,callback:function(t){e.$set(e.listQuery,"province",t)},expression:"listQuery.province"}},e._l(e.cities,function(t){return l("el-option",{key:t.id,attrs:{label:t.provinceName,value:t.provinceName}},[l("span",{staticStyle:{float:"left"}},[e._v(e._s(t.provinceName))])])}),1)],1),l("el-form-item",{attrs:{label:"运营商:"}},[l("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.listQuery.operator,callback:function(t){e.$set(e.listQuery,"operator",t)},expression:"listQuery.operator"}},e._l(e.operators,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[l("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))])])}),1)],1),l("el-form-item",{attrs:{label:"短信状态:"}},[l("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.listQuery.state,callback:function(t){e.$set(e.listQuery,"state",t)},expression:"listQuery.state"}},e._l(e.states,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[l("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))])])}),1)],1),l("el-form-item",{attrs:{prop:"message",label:"短信内容:"}},[l("el-input",{attrs:{placeholder:"短信内容"},model:{value:e.listQuery.message,callback:function(t){e.$set(e.listQuery,"message",t)},expression:"listQuery.message"}})],1),l("el-form-item",[l("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("\n        查询\n      ")])],1),l("el-form-item",[l("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.exportExcel}},[e._v("\n        导出\n      ")])],1)],1),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{size:"small",data:e.list,"element-loading-text":"正在查询中...",fit:"","highlight-current-row":""}},[l("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[l("el-form-item",{attrs:{label:"短信内容:"}},[l("span",[e._v(e._s(t.row.message))])]),l("el-form-item",{attrs:{label:"错误码:"}},[l("span",[e._v(e._s(t.row.errorCode))])]),l("el-form-item",{attrs:{label:"错误信息:"}},[l("span",[e._v(e._s(t.row.errorMessage))])])],1)]}}])}),l("el-table-column",{attrs:{label:"客户名",prop:"dimCustomer.username","min-width":"50"}}),l("el-table-column",{attrs:{label:"通道名",prop:"dimChannel.name","min-width":"60"}}),l("el-table-column",{attrs:{label:"手机号",prop:"mobile","min-width":"50"}}),l("el-table-column",{attrs:{label:"流水id",prop:"messageId","min-width":"100"}}),l("el-table-column",{attrs:{label:"省份",prop:"province",width:"80"}}),l("el-table-column",{attrs:{label:"运营商",prop:"operatorName",width:"80"}}),l("el-table-column",{attrs:{label:"计费条数",prop:"feeCount",width:"80"}}),l("el-table-column",{attrs:{label:"状态",prop:"stateName",width:"80"}}),l("el-table-column",{attrs:{label:"提交时间",prop:"submitTime",width:"80"}}),l("el-table-column",{attrs:{label:"发送时间",prop:"sendTime",width:"80"}}),l("el-table-column",{attrs:{label:"状态时间",prop:"reportTime",width:"80"}})],1),l("div",{staticClass:"pagination-container"},[l("el-pagination",{attrs:{background:"","current-page":e.listQuery.page+1,"page-sizes":[10,20,30,50],"page-size":e.listQuery.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},o=[],n=l("5d58"),s=l.n(n),i=l("67bb"),r=l.n(i);function c(e){return c="function"===typeof r.a&&"symbol"===typeof s.a?function(e){return typeof e}:function(e){return e&&"function"===typeof r.a&&e.constructor===r.a&&e!==r.a.prototype?"symbol":typeof e},c(e)}function u(e){return u="function"===typeof r.a&&"symbol"===c(s.a)?function(e){return c(e)}:function(e){return e&&"function"===typeof r.a&&e.constructor===r.a&&e!==r.a.prototype?"symbol":c(e)},u(e)}var p={name:"home",data:function(){return{loaded:!1,total:0,listLoading:!0,list:[],listQuery:{keywordType:"NAME",keyword:void 0,customerId:void 0,channelId:void 0,queryDate:this.$moment().format("YYYY-MM-DD"),province:void 0,mobile:void 0,operator:void 0,message:void 0,state:void 0,page:0,size:10},cities:[],provinceLoading:!1,operators:[{value:1,label:"移动"},{value:2,label:"电信"},{value:3,label:"联通"}],states:[{label:"未知",value:0},{label:"成功",value:1},{label:"策略失败",value:2},{label:"提交失败",value:3},{label:"状态失败",value:4},{label:"响应超时",value:5},{label:"状态超时",value:6},{label:"扣量",value:7}],customerOptions:[],customerLoading:!1,token:"",channelOptions:[],channelLoading:!1}},created:function(){this.loadList(),this.loadCustomerList(),this.loadChannelList(),this.loadProvinceList()},methods:{handleSizeChange:function(e){this.listQuery.size=e,this.loadList()},handleCurrentChange:function(e){this.listQuery.page=e-1,this.loadList()},exportExcel:function(){var e=this,t=Object.assign({},this.listQuery),l="http://localhost:9000/short_message/export?queryDate="+t.queryDate+"&";null!=t.state&&(l+="state="+t.state+"&"),null!=t.channelId&&(l+="channelId="+t.channelId+"&"),null!=t.customerId&&(l+="customerId="+t.customerId+"&"),null!=t.province&&""!=t.province&&(l+="province="+t.province+"&"),null!=t.mobile&&(l+="mobile="+t.mobile+"&"),null!=t.operator&&(l+="operator="+t.operator+"&"),null!=t.message&&(l+="message="+t.message+"&"),l=l.substr(0,l.length-1),this.$http.get(l).then(function(t){e.token=t.data.data}),this.checkState(this)},checkState:function(e){var t=e,l=setInterval(function(){t.$http.get("http://localhost:9000/short_message/checkState?token="+t.token).then(function(e){e.data.data&&(window.open("http://localhost:9000/short_message/download?token="+t.token),clearInterval(l))})},5e3)},search:function(){this.loadList()},loadList:function(e){var t=this,l=Object.assign({},this.listQuery,e);console.log(u(l.operator)),this.$http.get("http://localhost:9000/short_message/list",{params:l}).then(function(e){t.listQuery.page=l.page,t.listQuery.size=l.size,t.list=e.data.data,t.total=e.data.total,t.listLoading=!1},function(){return t.listLoading=!1})},loadCustomerList:function(){var e=this;this.customerLoading=!0,this.$http.get("http://localhost:9000/customer/list").then(function(t){e.customerOptions=t.data.data,e.customerLoading=!1},function(){return e.customerLoading=!1})},loadChannelList:function(){var e=this;this.channelLoading=!0,this.$http.get("http://localhost:9000/channel/list").then(function(t){e.channelOptions=t.data.data,e.channelLoading=!1},function(){return e.channelLoading=!1})},loadProvinceList:function(){var e=this;this.provinceLoading=!0,this.$http.get("http://localhost:9000/province/list").then(function(t){e.cities=t.data.data,e.provinceLoading=!1},function(){e.provinceLoading=!1})}}},d=p,m=(l("5a4c"),l("2877")),h=Object(m["a"])(d,a,o,!1,null,null,null);t["default"]=h.exports},"5a4c":function(e,t,l){"use strict";var a=l("bda6"),o=l.n(a);o.a},"5d58":function(e,t,l){e.exports=l("d8d6")},"67bb":function(e,t,l){e.exports=l("f921")},bda6:function(e,t,l){}}]);
//# sourceMappingURL=chunk-1c90cf17.7223258d.js.map